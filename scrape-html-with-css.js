const puppeteer = require('puppeteer');
const { PurgeCSS } = require('purgecss');
const fs = require('fs');

async function scrapeFooter() {
    const browser = await puppeteer.launch({ headless: "new" });
    const page = await browser.newPage();
    await page.goto('https://jasper.ai');

    // Pridobivanje HTML vsebine footer elementa
    const footerHTML = await page.evaluate(() => {
        const footer = document.querySelector('.footer-tb');
        return footer.outerHTML;
    });

    await browser.close();

    // Shranjevanje v datoteko
    fs.writeFileSync('footer.html', footerHTML);

    // Izvajanje PurgeCSS
    const purgeCSSResult = await new PurgeCSS().purge({
        content: ['footer.html'],
        css: ['./jasper_styles.css'],  // Ročno določite pot do vaše datoteke CSS
    });

    // Preverjanje, ali je PurgeCSS vrnil kakršne koli stile
    if (purgeCSSResult.length > 0 && purgeCSSResult[0].css) {
        fs.writeFileSync('purged-styles.css', purgeCSSResult[0].css);
    } else {
        console.error('No CSS was generated by PurgeCSS');
    }
}

scrapeFooter();

//-----------
const fs = require('fs');

const css = fs.readFileSync('purged-styles.css', 'utf-8');
const footerHTML = fs.readFileSync('footer.html', 'utf-8');

const updatedFooterHTML = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Footer</title>
<style>
${css}
</style>
</head>
<body>
${footerHTML}
</body>
</html>
`;

fs.writeFileSync('updated-footer.html', updatedFooterHTML);
