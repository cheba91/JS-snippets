<script async src="https://cdn.jsdelivr.net/npm/countup@1.8.2/dist/countUp.min.js"></script>
<script>
window.addEventListener('load', () => {
  const handleIntersection = (entries, observer) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const el = entry.target;
        const originalText = el.textContent;
        const mainNumber = originalText.split(',')[0];
        const endValue = parseInt(mainNumber.replace(/\./g, '').replace(/[^0-9-]/g, ''));

        const options = {
          useEasing: true,
          useGrouping: true, // This enables thousand separators
          separator: '.', // Use dot as thousand separator
          decimal: ',', // Use comma as decimal separator
        };

        const counter = new CountUp(el.id, 0, endValue, 0, 3, options);

        if (!counter.error) {
          counter.start();
          observer.unobserve(el);
        } else console.error(counter.error);
      }
    });
  };

  const counters = document.querySelectorAll('.facts-item__statistic .h1-l strong');

  counters.forEach((counter, index) => {
    if (!counter.id) counter.id = `counter-${index}`;
  });

  const observer = new IntersectionObserver(handleIntersection, {
    threshold: 0.5,
  });

  counters.forEach((counter) => observer.observe(counter));
});

</script>
