<style>
  .service-tabs__menu.is--final {
    position: absolute;
    bottom: 0;
  }
  .service-tabs__menu.is--initial {
    position: absolute;
    top: 0;
    bottom: auto;
  }
  .service-tabs__menu {
    z-index: 2;
    grid-column-gap: 0.3125rem;
    grid-row-gap: 0.3125rem;
    border: 1px solid var(--borders--button-subtle);
    background-color: var(--dark-700);
    -webkit-backdrop-filter: blur(50px);
    backdrop-filter: blur(50px);
    border-radius: 20px;
    grid-template-rows: auto;
    grid-template-columns: 1fr 1fr;
    grid-auto-columns: 1fr;
    padding: 0.3125rem;
    display: grid;
    position: fixed;
    inset: auto auto 32px 50%;
    transform: translate(-50%);
  }
</style>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const menu = document.querySelector('.service-tabs__menu');
    const container = document.querySelector('.service-tabs');

    if (!menu || !container) return;

    const TRIGGER_OFFSET = 32;

    window.addEventListener('scroll', () => {
      const menuRect = menu.getBoundingClientRect();
      const containerRect = container.getBoundingClientRect();
      const containerHeight = containerRect.height;
      const menuHeight = menuRect.height;

      const distanceToTop = menuRect.top - containerRect.top;
      const distanceToBottom = menuRect.bottom - containerRect.bottom;
      const distanceToViewportBottom = window.innerHeight - menuRect.bottom;

      const isInsideContainer = distanceToTop >= 0 && distanceToBottom <= 0;

      // Check if the menu is outside the container
      if (distanceToBottom < 0 && distanceToTop < 0) {
        menu.classList.add('is--initial');
        menu.classList.remove('is--final');
        //   console.log('Outside container at the top');
      } else if (distanceToTop + menuHeight > containerHeight && distanceToBottom > 0) {
        menu.classList.add('is--final');
        menu.classList.remove('is--initial');
        //   console.log('Outside container at the bottom');
      }

      if (isInsideContainer && distanceToViewportBottom > TRIGGER_OFFSET && containerHeight > distanceToTop + menuHeight) {
        menu.classList.remove('is--initial', 'is--final');
      } else if (isInsideContainer && distanceToViewportBottom <= TRIGGER_OFFSET && containerHeight > Math.abs(distanceToBottom) + menuHeight) {
        menu.classList.remove('is--initial', 'is--final');
      }
    });
  });
</script>
